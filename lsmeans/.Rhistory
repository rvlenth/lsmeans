lsmeans(swiss.rg, "Infant.Mortality")
lsmeans(swiss.rg, "Examination")
lsmeans(swiss.rg, "Examination", by = "Infant.Mortality")
swiss.rg
summary(swiss.lm)
lsmip(swiss.rg, Infant.Mortality ~ Examination | Agriculture, ylab="Predicted Fertility")
?swiss
pairs(swiss)
summary(swiss.rg)
predict(swiss.rg)
q("no")
source('H:/progs/R/devel/LSMEANS/lsmeans/test-data.R')
library(lsmeans)
setwd(c:/Lrmth/temp)
setwd("c:/Lenth/temp")
dir()
rource("battery.r")
source("battery.r")
fun <- read.csv('battery.csv', header=TRUE)
fun
result <- lm(lifetime ~ brand, data=fun)
result.lsmo <- lsmeans(result, ~brand, adjust='tukey')
result.pairs <- pairs(result.lsmo, adjust='tukey')
summary(result.pairs, infer=TRUE)
result <- lm(lifetime ~ brand, data=fun)
result.lsmo <- lsmeans(result, ~brand, adjust='tukey')
result <- lm(lifetime ~ brand, data=fun)
result.lsmo <- lsmeans(result, ~brand)
result <- lm(lifetime ~ brand, data=fun)
result.lsmo <- lsmeans(result, ~brand)
confint(pairs(result.lsmo))
q("no")
library(lsmeans)
library(lsmeans)
library(lsmeans)
oranges.mlm = lm(cbind(sales1,sales2) ~ price1+price2+day+store, data=oranges)
ref.grid(oranges.mlm)
ref.grid(oranges.mlm, mult.name="variety")
?mlm
?lm
?polr
help("polr",package="MASS")
MOats
names(MOats$yield)
names(MOats$yield) = c(0,.2,.4,.6)
MOats
dimnames(MOats$yield)[[2]] = c(0,.2,.4,.6)
MOats
getwd
getwd()
dir("data")
save(list=MOats, file="data/MOats.RData")
save(list="MOats", file="data/MOats.RData")
library(lsmeans)
example(ref.grid)
ref.grid(MOats.lm, mult.levs = list(T=LETTERS[1:2], U=letters[1:2]))
?ref.grid
show(ref.grid(MOats.lm, mult.levs = list(T=LETTERS[1:2], U=letters[1:2])))
library(lsmeans)
oranges.lm1 = lm(sales1 ~ price1 + price2 + day + store, data = oranges)
days.lsm = lsmeans(oranges.lm1, "day")
( days.sum = summary(days.lsm, infer=c(TRUE,TRUE), level=.90, adjust="bon") )
with(days.sum, {
plot(lsmean ~ day, ylim = range(c(lower.CL, upper.CL)))
segments(day,lower.CL, day, upper.CL)  })
args(segments)
with(days.sum, {
plot(lsmean ~ day, ylim = range(c(lower.CL, upper.CL)))
segments(x0=day, y0=lower.CL, y1=upper.CL)  })
with(days.sum, {
plot(lsmean ~ day, ylim = range(c(lower.CL, upper.CL)))
})
plot(lsmean ~ day, ylim = range(c(lower.CL, upper.CL)), data=days.sum)
plot(lsmean ~ day, ylim = range(c(lower.CL, upper.CL)), data=days.sum, type="p")
plot(lsmean ~ lower.CL, ylim = range(c(lower.CL, upper.CL)), data=days.sum, type="p")
days.sum = within(days.sum, Day <- as.numeric(day))
days.sum
plot(lsmean ~ Day, ylim = range(c(lower.CL, upper.CL)), data=days.sum)
args(segments)
segments(Day, y0=lower>CL, y1=upper.CL, data=days.sum)
with(days.sum, segments(Day, y0=lower>CL, y1=upper.CL))
with(days.sum, segments(Day, y0=lower.CL, y1=upper.CL))
q("no")
q("no")
q("no")
library(lsmeans)
MOats
subs = which(with(MOats, Variety=="Victory" & Block %in% c("II","V")))
subs
Moats.lm = lm(yield ~ Block*Variety, data=MOats, subset = -subs)
MOats.lm
Moats.lm
setwd("c:/lenth/temp")
dir()
source("mypredict.R")
predict(MOats.lm, new=MOats)
predict(Moats.lm, new=MOats)
mypredict(Moats.lm, new=MOats)
stats:::predict.mlm
q("no")
library(lsmeans)
?update.ref.grid
q("no")
?? multidimensional
?dist
dist = matrix(0, nrow=8, ncol=8)
dist[1,2]=dist[3,4]=dist[5,6]=dist[7,8]=1
dist
dist = dist+t(dist)
dist
dimnames(dist)=list(LETTERS[1:8],LETTERS[1:8])
dist
library(MASS)
isoMDS(dist, k=1)
Shepard(dist,p=2)
cmdscale(dist,k=1)
zapsmall(cmdscale(dist,k=1))
sort(zapsmall(cmdscale(dist,k=1)))
sammon(dist, k=1)
LETTERS[order(cmdscale(dist,k=1))]
order(cmdscale(dist,k=1))
cmdscale(matrix(0, nrow=5, ncol=5), k=1)
fuzz=matrix(runif(64), ncol=8)
fuzz = (fuzz + t(fuzz))/2
diag(fuzz) = rep(0,8)
fuzz
isoMDS(dist + .1*fuzz, k=1)
order(.Last.value$points)
order(cmdscale(dist+.1*fuzz, k=1))
fuzz
dist + .1*fuzz
apply(dist+.1*fuzz, 1, sum)
apply(dist, 1, sum)
?eurodist
eurodist
as.dist(dist)
?as.dist
dist(runif(5))
as.matrix(dist(runif(5)))
d = as.dist(dist)
d[1,2]
d[1]
d[5]
q("no")
q("no")
eff.aovlist
Block <- gl(8, 4)
A<-factor(c(0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1))
B<-factor(c(0,0,1,1,0,0,1,1,0,1,0,1,1,0,1,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1))
C<-factor(c(0,1,1,0,1,0,0,1,0,0,1,1,0,0,1,1,0,1,0,1,1,0,1,0,0,0,1,1,1,1,0,0))
Yield <- c(101, 373, 398, 291, 312, 106, 265, 450, 106, 306, 324, 449,
272, 89, 407, 338, 87, 324, 279, 471, 323, 128, 423, 334,
131, 103, 445, 437, 324, 361, 302, 272)
aovdat <- data.frame(Block, A, B, C, Yield)
old <- getOption("contrasts")
options(contrasts=c("contr.helmert", "contr.poly"))
(fit <- aov(Yield ~ A*B*C + Error(Block), data = aovdat))
eff.aovlist(fit)
summary(fit)
eff(fit)
eff.aovlist(fit)
vcov(fit[[2]])
zapsmall(vcov(fit[[2]]))
zapsmall(vcov(fit[[3]]))
13.29236/32.25391
fit1 = update(fit1, subset = -11)
fit1 = update(fit, subset = -11)
fit
fit1 = aov(Yield ~ A*B*C + Error(Block), data = aovdat, subset=-11)
summary(fit1)
eff.aovlist(fit1)
library(lsmeans)
lsmeans(fit, "A")
zapsmall(vcov(fit[[3]]))
zapsmall(vcov(fit1[[3]]))
zapsmall(vcov(fit1[[2]]))
data(Oats, package="nlme")
Oats.aov = aov(yield~Variety+factor(nitro) + Error(Block/Variety), data=Oats)
eff.aovlist(Oats.aov)
Oats17.aov = aov(yield~Variety+factor(nitro) + Error(Block/Variety), subset=-17, data=Oats)
eff.aovlist(Oats.aov)
eff.aovlist(Oats17.aov)
vcov(Oats17.aov[[2]])
vcov(Oats17.aov[[3]])
vcov(Oats17.aov[[4]])
coef(Oats17.aov[[2]])
coef(Oats17.aov[[3]])
coef(Oats17.aov[[4]])
lapply(Oats.aov, coef)
lapply(Oats17.aov, coef)
eff.aovlist(Oats17.aov)
model.tables(Oats17.aov, se=TRUE)
model.tables(Oats.aov, se=TRUE)
q("no")
library(lme4)
data(Oats, package = "nlme")
Oats.lmer <- lmer(yield ~ factor(nitro)*Variety + (1|Block/Variety), data = Oats, subset = -c(1,2,3,5,8,13,21,34,55))
library(lsmeans)
lsmeans(Oats.lmer,  ~ Variety|nitro)
lsmeans(Oats.lmer,  ~ Variety|nitro)
lsmeans(Oats.lmer,  ~ Variety|nitro)
junk = function(x) {
if(x || requireNamespace("xyz")) cat("x is TRUE")
else cat("x is FALSE")
invisible()
}
junk(TRUE)
junk(FALSE)
junk(TRUE)
junk(FALSE)
fix(junk)
junk(FALSE)
junk(TRUE)
if(getOption("lsmeans")$xyz) TRUE else FALSE
.lsm.is.true = function(opt) {
x = getOption("lsmeans")[[opt]]
if (is.null(x))  FALSE
else if (is.logical(x))  x
else FALSE
}
.lsm.is.true("xyz")
lsm.options(xyz=TRUE)
.lsm.is.true("xyz")
lsm.options(xyz="Now is the time")
.lsm.is.true("xyz")
lsm.options(xyz=FALSE)
.lsm.is.true("xyz")
library(lsmeans)
lsmeans(Oats.lmer,  ~ Variety|nitro)
lsm.options(disable.pbkrtest=TRUE)
lsmeans(Oats.lmer,  ~ Variety|nitro)
library(lsmeans)
lsm.options(disable.pbkrtest=NULL)
lsmeans(Oats.lmer,  ~ Variety|nitro)
lsm.options(disable.pbkrtest = TRUE)
lsmeans(Oats.lmer,  ~ Variety|nitro)
lsm.options(disable.pbkrtest = FALSE)
lsmeans(Oats.lmer,  ~ Variety|nitro)
lsm.options()
print(lsm.options())
library(lsmeans)
lsmeans(Oats.lmer,  ~ Variety|nitro)
lsm.options(disable.pbkrtest = TRUE)
lsmeans(Oats.lmer,  ~ Variety|nitro)
q("no")
install.packages(c("AER", "agridat", "AlgDesign", "car", "caTools", "chron", "DAAG", "desirability", "devtools", "DiceDesign", "DoE.base", "dynlm", "e1071", "Ecdat", "effects", "evaluate", "foreach", "FrF2", "fts", "gam", "gdata", "ggplot2", "gplots", "gss", "gtools", "Hmisc", "httpuv", "httr", "igraph", "ineq", "iterators", "itertools", "lattice", "lme4", "lmtest", "lsmeans", "memoise", "minqa", "mixexp", "mixtools", "multcomp", "mvtnorm", "np", "odfWeave", "oz", "party", "plyr", "prodlim", "R.matlab", "R.oo", "R.utils", "Rcmdr", "Rcpp", "RcppEigen", "relax", "reshape", "reshape2", "rggobi", "RGtk2", "RJSONIO", "robustbase", "rsm", "sampleSelection", "SASmixed", "scales", "scatterplot3d", "segmented", "sem", "sfsmisc", "shiny", "statmod", "tcltk2", "TH.data", "tweedie", "VGAM", "xtable", "zoo"))
q("no")
install.packages("glmmADMB", repos="http://r-forge.r-project.org", type="source")
library(glmmADMB)
installed.packages()[,1]
install.packages("glmmADMB", repos=c("http://glmmadmb.r-forge.r-project.org/repos", getOption("repos")),type="source")
library(glmmADMB)
example(glmmADMB)
?glmmADMB
example(glmmadmb)
class(om)
class(bfit)
ls()
u
zi
d
call(bfit)
names(bfit)
summary(bfit)
bfit$call
class(bfit)
library(lsmeans)
ref.grid(bfit)
recover.data.glmmadmb <- lsmeans:::recover.data.lm
ref.grid(bfit)
recover.data(bfit, data=NULL)
names(bfit)
fixef(bfit)
lsmeans:::lsm.basis.merMod
coef(bfit)
lsmeans:::lsm.basis.lme
lsm.basis.glmmadmb = lsmeans:::lsm.basis.lme
ref.grid(binfit)
ref.grid(bfit)
bfit$family
names(bfit)
bfit$link
bfit$linkfun
bfit$ilinkfun
fix(lsm.basis.glmmadmb)
ref.grid(bfit)
lsmeans(bfit, trt)
lsmeans(bfit, ~trt)
pairs(lsmeans(bfit, ~trt))
bfl = lsmeans(bfit, ~trt)
summary(bfl, type="r")
summary(pairs(bfl), type="r")
fix(lsm.glmmadmb)
fix(lsm.basis.glmmadmb)
bfit$family
pmatch("binom", "binomial")
pmatch("binomo", "binomial")
fix(lsm.basis.glmmadmb)
bfl = lsmeans(bfit, ~trt)
summary(bfl, type="r")
lsm.basis.glmmadmb
( bfit.lsm = lsmeans(bfit, "trt") )
pairs(bfit.lsm)
summary(.Last.value, type = "response")
?extending-lsmeans
?"extending-lsmeans"
vignette("using-lsmeans")
X = matrix(rnorm(20), nrow=5)
X
wtavg = function(w) function(X) apply(diag(w) %*% X, 2, sum)
wtavg(1:5)(X)
wtavg = function(w) function(X) apply(diag(w) %*% X, 2, sum) / sum(w)
wtavg(1:5)(X)
X = matrix(rnorm(20), nrow=5)
wtavg(1:5)
ls()
lsmeans(bfit)
lsmeans(bfit,"trt")
example(lsmeans)
ls()
fiber.lsm
lsmeans(Oats.lme, "nitro")
lsmeans(Oats.lme, "nitro", fac.reduce = wtavg(1:3))
lsmeans(Oats.lme, "nitro", fac.reduce = wtavg(c(3,7,2)))
lsmeans(Oats.lme, "nitro")
lsmeans(Oats.lme, "nitro", fac.reduce = wtavg(c(3,7,2)))
?blas
??blas
??"quadratic form"
?"%*%"
nonest.basis
X = matrix(rnorm(25), nrow=5)
X
r=3
idx = r + seq_length(5-r)
idx = r + seq_len(5-r)
idx
diag(X[idx,idx]) = 1
X
q("no")
-seq_len(2)
-seq_len(2)
-seq_len(2)
args(seq_len)
seq_len(k)
k=5
seq_len(k)
seq_len(k)
rank = 7
p = 10
X = matrix(0, nrow=10, ncol=10)
tR=X
extras = rank + seq_len(p - rank)
diag(tR[extras,extras]) = 1
tR
-seq_len(rank)
qr(tR))[ , extras, drop = FALSE]
qr(tR)[ , extras, drop = FALSE]
tR[ , extras, drop = FALSE]
seq_len(k-1)
i=2
i + seq_len(k-i)
seq_len(i-1)
library(lsmeans)
example(lsmeans)
library(lsmeans)
example(lsmeans)
.libPaths()
?.libPaths
q("no")
install.packages(c("agridat", "Ecdat", "gplots", "heplots", "lme4", "mboost", "np", "party", "rgl"))
library(lsmeans)
example(lsmeans)
ls()
Oats.lme
Oats.lmer = lmer(yield ~ factor(nitro) + Variety + (1|Block/Variety), data = Oats)
library(lme4)
Oats.lmer = lmer(yield ~ factor(nitro) + Variety + (1|Block/Variety), data = Oats)
lsmeans(Oats.lmer, "Variety")
lsmeans(Oats.lmer, "nitro")
Oats.aov = lmer(yield ~ factor(nitro) + Variety + Error(Block/Variety), data = Oats)
Oats.aov = aov(yield ~ factor(nitro) + Variety + Error(Block/Variety), data = Oats)
lsmeans(Oats.aov, "nitro")
options(contrasts=c("contr.sum","contr.poly"))
Oats.aov = aov(yield ~ factor(nitro) + Variety + Error(Block/Variety), data = Oats)
lsmeans(Oats.aov, "nitro")
lsmeans(Oats.lmer, "nitro")
lsmeans(Oats.aov, "Variety")
lsmeans(Oats.lmer, "Variety")
library(pbkrtest)
example(pbkrtest)
ls(2)
example(KRmodcomp)
?getKR
data(beets, package='pbkrtest')
lg <- lmer(sugpct ~ block + sow + harvest + (1|block:harvest),
data=beets)
data(beets, package='pbkrtest')
beets.lmer <- lmer(sugpct ~ block + sow + harvest + (1|block:harvest),
data=beets)
beets.aov <- aov(sugpct ~ block + sow + harvest + Error(block:harvest),
data=beets)
beets.aov <- aov(sugpct ~ block + sow + harvest + Error(block:harvest), data=beets)
lsmeans(beets.ova, "sow")
lsmeans(beets.aov, "sow")
lsmeans(beets.lmer, "sow")
lsmeans(beets.aov, "harvest")
lsmeans(beets.lmer, "harvest")
lsmeans(beets.aov, c("harvest","sow"))
lsmeans(beets.lmer, c("harvest","sow"))
pairs(lsmeans(beets.aov, "harvest"))
pairs(lsmeans(beets.lmer, "harvest"))
pairs(lsmeans(beets.aov, "sow"))
pairs(lsmeans(beets.lmer, "sow"))
q("no")
library(lsmeans)
citation("lsmeans")
data(Oats, package="nlme")
library(lme4)
Oats = transform(Oats, nitro = factor(nitro))
Oats.lmer = lmer(log(yield) ~ Variety + nitro + (1|Block/Variety), data=Oats)
lsmeans(Oats.lmer, "nitro|Variety")
lsmeans(Oats.lmer, ~nitro|Variety)
example(lsmeans)
ls()
warp.lsm
lsmip(warp.lsm, tension ~ wool)
library(effects)
allEffects(warp.lm)
plot(allEffects(warp.lm))
as.data.frame(allEffects(warp.lm))
summary(allEffects(warp.lm))
summary(Effect("Variety",warp.lm))
Effect("Variety",warp.lm)
Effect("Variety",Oats.lmer)
plot(Effect("Variety",Oats.lmer))
?plot.effect
?plot.effects
?plot
?Effect
plot(Effect("Variety",Oats.lmer, type="response"))
plot(Effect("Variety",Oats.lmer) type="response")
plot(Effect("Variety",Oats.lmer), type="response")
class(Effect("Variety",Oats.lmer))
print.default(Effect("Variety",Oats.lmer))
args(Effect)
?Effect
plot(Effect("Variety",Oats.lmer,tran="log"), type="response")
plot(Effect("Variety",Oats.lmer,tran=log), type="response")
plot(Effect("Variety",Oats.lmer,tran=list(link=log,inverse=exp), type="response")
)
plot(Effect("Variety",Oats.lmer,tran=list(link=log,inverse=exp)), type="response")
plot(Effect(c("Variety","nitro"),Oats.lmer,tran=list(link=log,inverse=exp)), type="response")
ls()
fiber.lsm
plot(allEffects(fiber.lm))
as.data.frame(Effect("machine",fiber.lm))
example(nutrition)
ls()
plot(allEffects(nutr.aov))
lsmip(nutr.lsm, group ~ race)
lsmeans(nutr.lm, ~race|group)
lsmeans(nutr.lsm, ~race|group)
summary(Effect(c("group","race"),nutr.lm))
Effect(c("group","race"),nutr.lm)
Effect(c("group","race"),nutr.aov)
lsmeans(nutr.aov, ~group*race)
q("no")
library(lsmeans)
Tbl = with(nutrition, table(group,race,age))
tBL
Tbl
as.numeric(Tbl)
table
?vapply
apply(nutrition, 1, names)
library(plyr)
ls(2)
?vaggregate
names(nutrition)
with(nutrition, vaggregate(gain, cbind(group,race), sum)
)
with(nutrition, tapply(gain, cbind(group,race), sum))
?count
count(nutrition, c("group","age"))
count(nutrition, c("group","race","age"))
q("no")
library(lsmeans)
example(oranges)
ref.grid(oranges.lm)
str(lsmeans(oranges.lm, ~day))
lsmeans(oranges.lm, ~day)@linfct
?step
library(lsmeans)
mod = lm(strength~diameter, data=fiber)
add1(mod, scope=~.)
step(mod)
add1(mod, scope=~machine)
names(fiber)
add1(mod, ~machine)
mod = lm(Fertility ~ Education, data=swiss)
add1(mod, ~.)
add1(mod, ~., data=swiss)
names(swiss)
add1(mod, ~Agriculture+Catholic)
add1(mod, list(upper=~Agriculture+Catholic))
step(mod, list(upper=~Agriculture+Catholic))
step(mod, ~Agriculture+Catholic)
?stepAIC
library(MASS)
?stepAIC
q("no")
